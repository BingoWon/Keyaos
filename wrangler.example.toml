#:schema node_modules/wrangler/config-schema.json

name = "keyaos"
main = "worker/index.ts"
compatibility_date = "2025-12-01"
compatibility_flags = ["nodejs_compat"]

[vars]
ADMIN_TOKEN = "admin"    # Core auth: change this! Used as Bearer token for dashboard + API.
CNY_USD_RATE = "7"       # CNY â†’ USD exchange rate (used for DeepSeek balance conversion)
# Platform mode (optional): set CLERK_PUBLISHABLE_KEY here, secrets via `wrangler secret put` or .dev.vars
# CLERK_PUBLISHABLE_KEY = "pk_test_xxxxx"
# Secrets: CLERK_SECRET_KEY, STRIPE_SECRET_KEY, STRIPE_WEBHOOK_SECRET
# Frontend: VITE_CLERK_PUBLISHABLE_KEY in .env.local (same value, Vite requires VITE_ prefix)

[assets]
directory = "./dist"
binding = "ASSETS"

[[d1_databases]]
binding = "DB"
database_name = "keyaos-db"
database_id = "YOUR_D1_DATABASE_ID_HERE"      # Replace after: npx wrangler d1 create keyaos-db
migrations_dir = "migrations"

[observability]
enabled = true
head_sampling_rate = 1

[triggers]
crons = ["*/5 * * * *"]
